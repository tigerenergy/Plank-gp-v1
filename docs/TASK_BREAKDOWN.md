# 📋 주간보고 기능 개발 태스크 분해

> **프로젝트**: Plank  
> **기능**: 주간보고 작성 및 통합 워크플로우  
> **작성일**: 2026-01-21

---

## 🎯 목표

주간보고 기능을 통해:
1. 개인별 주간보고 작성 (완료/진행중/이슈 포함)
2. 부장의 통합 보고서 생성
3. 상급자 보고 기능

---

## 📦 Phase 1: 데이터베이스 및 백엔드

### Task 1.1: weekly_reports 테이블 생성
**우선순위**: 🔴 높음  
**예상 시간**: 1시간

- [ ] 마이그레이션 파일 생성: `021_add_weekly_reports.sql`
- [ ] 테이블 스키마 작성
- [ ] RLS 정책 설정
- [ ] 인덱스 추가 (board_id, user_id, week_start_date)
- [ ] 테스트 데이터 삽입 및 조회 테스트

**체크리스트**:
- [ ] 마이그레이션 파일 작성 완료
- [ ] Supabase에서 실행 테스트
- [ ] RLS 정책 검증

---

### Task 1.2: weekly_report_cards 테이블 생성
**우선순위**: 🔴 높음  
**예상 시간**: 1시간

- [ ] 마이그레이션 파일 생성: `022_add_weekly_report_cards.sql`
- [ ] 테이블 스키마 작성
- [ ] RLS 정책 설정
- [ ] 인덱스 추가
- [ ] 테스트 데이터 삽입 및 조회 테스트

**체크리스트**:
- [ ] 마이그레이션 파일 작성 완료
- [ ] Supabase에서 실행 테스트
- [ ] RLS 정책 검증

---

### Task 1.3: integrated_reports 테이블 생성
**우선순위**: 🔴 높음  
**예상 시간**: 1시간

- [ ] 마이그레이션 파일 생성: `023_add_integrated_reports.sql`
- [ ] 테이블 스키마 작성
- [ ] RLS 정책 설정
- [ ] 인덱스 추가
- [ ] 테스트 데이터 삽입 및 조회 테스트

**체크리스트**:
- [ ] 마이그레이션 파일 작성 완료
- [ ] Supabase에서 실행 테스트
- [ ] RLS 정책 검증

---

### Task 1.4: integrated_report_contributions 테이블 생성
**우선순위**: 🟡 중간  
**예상 시간**: 30분

- [ ] 마이그레이션 파일 생성: `024_add_integrated_report_contributions.sql`
- [ ] 테이블 스키마 작성
- [ ] RLS 정책 설정
- [ ] 테스트 데이터 삽입 및 조회 테스트

**체크리스트**:
- [ ] 마이그레이션 파일 작성 완료
- [ ] Supabase에서 실행 테스트

---

### Task 1.5: Server Actions 작성 - 주간보고 CRUD
**우선순위**: 🔴 높음  
**예상 시간**: 4시간

- [ ] `app/actions/weekly-report.ts` 파일 생성
- [ ] `createWeeklyReport()` - 주간보고 생성
- [ ] `updateWeeklyReport()` - 주간보고 수정
- [ ] `submitWeeklyReport()` - 주간보고 제출
- [ ] `getWeeklyReport()` - 주간보고 조회
- [ ] `getWeeklyReportsByBoard()` - 보드별 주간보고 목록
- [ ] `deleteWeeklyReport()` - 주간보고 삭제 (선택사항)

**체크리스트**:
- [ ] 각 함수 타입 정의 완료
- [ ] 에러 핸들링 구현
- [ ] RLS 정책 테스트
- [ ] 유효성 검사 (Zod 스키마)

---

### Task 1.6: Server Actions 작성 - 통합 보고서 CRUD
**우선순위**: 🔴 높음  
**예상 시간**: 4시간

- [ ] `app/actions/integrated-report.ts` 파일 생성
- [ ] `createIntegratedReport()` - 통합 보고서 생성
- [ ] `updateIntegratedReport()` - 통합 보고서 수정
- [ ] `finalizeIntegratedReport()` - 통합 보고서 확정
- [ ] `getIntegratedReport()` - 통합 보고서 조회
- [ ] `getIntegratedReportsByBoard()` - 보드별 통합 보고서 목록
- [ ] `sendIntegratedReport()` - 통합 보고서 전송 (이메일)

**체크리스트**:
- [ ] 각 함수 타입 정의 완료
- [ ] 에러 핸들링 구현
- [ ] RLS 정책 테스트
- [ ] 유효성 검사 (Zod 스키마)

---

## 🎨 Phase 2: 주간보고 작성 UI

### Task 2.1: 주간보고 작성 페이지 컴포넌트
**우선순위**: 🔴 높음  
**예상 시간**: 3시간

- [ ] `app/board/[id]/weekly-report/page.tsx` 생성
- [ ] `app/board/[id]/weekly-report/WeeklyReportClient.tsx` 생성
- [ ] 주간보고 작성 레이아웃 구성
- [ ] 완료된 카드 자동 수집 로직
- [ ] 진행 중인 카드 목록 표시

**체크리스트**:
- [ ] 페이지 라우팅 설정
- [ ] 완료된 카드 수집 로직 구현
- [ ] 진행 중인 카드 필터링 로직
- [ ] 반응형 디자인 적용

---

### Task 2.2: 카드 진행상황 입력 폼
**우선순위**: 🔴 높음  
**예상 시간**: 3시간

- [ ] `app/components/weekly-report/CardProgressForm.tsx` 생성
- [ ] 진행률 입력 (슬라이더 또는 숫자 입력)
- [ ] 현재 상태 텍스트 영역
- [ ] 예상 완료일 날짜 선택기
- [ ] 이슈사항 입력 필드

**체크리스트**:
- [ ] 폼 유효성 검사 (React Hook Form + Zod)
- [ ] 진행률 0-100% 제한
- [ ] 날짜 선택기 연동
- [ ] 실시간 저장 (선택사항)

---

### Task 2.3: 이슈사항 관리 UI
**우선순위**: 🟡 중간  
**예상 시간**: 2시간

- [ ] `app/components/weekly-report/IssueList.tsx` 생성
- [ ] 이슈사항 추가 버튼
- [ ] 이슈사항 목록 표시
- [ ] 이슈사항 수정/삭제 기능

**체크리스트**:
- [ ] 이슈사항 추가 모달/폼
- [ ] 이슈사항 목록 UI
- [ ] 수정/삭제 기능
- [ ] 드래그앤드롭 정렬 (선택사항)

---

### Task 2.4: 주간보고 저장 및 제출
**우선순위**: 🔴 높음  
**예상 시간**: 2시간

- [ ] 임시 저장 기능 (draft 상태)
- [ ] 제출 기능 (submitted 상태)
- [ ] 제출 전 유효성 검사
- [ ] 제출 후 알림 (부장에게)

**체크리스트**:
- [ ] 저장 버튼 구현
- [ ] 제출 버튼 구현
- [ ] 유효성 검사 로직
- [ ] 성공/실패 피드백 (Toast)

---

## 📊 Phase 3: 통합 보고서 UI

### Task 3.1: 통합 보고서 페이지 컴포넌트
**우선순위**: 🔴 높음  
**예상 시간**: 3시간

- [ ] `app/board/[id]/integrated-report/page.tsx` 생성
- [ ] `app/board/[id]/integrated-report/IntegratedReportClient.tsx` 생성
- [ ] 제출 현황 대시보드
- [ ] 미제출자 목록 표시
- [ ] 통합 보고서 생성 버튼

**체크리스트**:
- [ ] 페이지 라우팅 설정
- [ ] 제출 현황 UI 구현
- [ ] 미제출자 알림 기능
- [ ] 권한 체크 (보드 소유자만)

---

### Task 3.2: AI 통합 보고서 생성
**우선순위**: 🟡 중간  
**예상 시간**: 4시간

- [ ] `lib/gemini.ts`에 통합 보고서 생성 함수 추가
- [ ] 팀원들의 주간보고 수집
- [ ] AI 프롬프트 작성
- [ ] Gemini API 호출
- [ ] 보고서 요약 생성
- [ ] 통계 데이터 생성

**체크리스트**:
- [ ] AI 프롬프트 최적화
- [ ] 에러 핸들링
- [ ] 로딩 상태 표시
- [ ] 생성된 보고서 미리보기

---

### Task 3.3: 통합 보고서 편집 UI
**우선순위**: 🟡 중간  
**예상 시간**: 3시간

- [ ] 통합 보고서 편집 폼
- [ ] 보고서 내용 수정 (Markdown 에디터)
- [ ] 코멘트 추가 기능
- [ ] 최종 확정 버튼

**체크리스트**:
- [ ] Markdown 에디터 연동 (선택사항)
- [ ] 실시간 미리보기
- [ ] 저장 기능
- [ ] 최종 확정 기능

---

### Task 3.4: 보고서 전송 기능
**우선순위**: 🟢 낮음  
**예상 시간**: 3시간

- [ ] 이메일 전송 기능 (Resend)
- [ ] PDF 생성 및 다운로드
- [ ] 링크 공유 기능

**체크리스트**:
- [ ] 이메일 템플릿 작성
- [ ] PDF 생성 라이브러리 연동
- [ ] 다운로드 기능
- [ ] 링크 공유 UI

---

## 📚 Phase 4: 보고서 아카이브

### Task 4.1: 보고서 아카이브 페이지
**우선순위**: 🟢 낮음  
**예상 시간**: 2시간

- [ ] `app/board/[id]/reports/page.tsx` 생성
- [ ] 과거 보고서 목록 표시
- [ ] 필터링 (주간/월간)
- [ ] 검색 기능

**체크리스트**:
- [ ] 페이지 라우팅 설정
- [ ] 목록 UI 구현
- [ ] 필터링 로직
- [ ] 검색 기능

---

### Task 4.2: 보고서 상세 조회
**우선순위**: 🟢 낮음  
**예상 시간**: 2시간

- [ ] 보고서 상세 모달/페이지
- [ ] 개인 보고서 상세 표시
- [ ] 통합 보고서 상세 표시
- [ ] 인쇄 기능 (선택사항)

**체크리스트**:
- [ ] 상세 UI 구현
- [ ] Markdown 렌더링
- [ ] 인쇄 스타일 (선택사항)

---

## 🔔 Phase 5: 알림 및 통합

### Task 5.1: 주간보고 알림
**우선순위**: 🟡 중간  
**예상 시간**: 2시간

- [ ] 주간보고 작성 알림 (매주 월요일)
- [ ] 제출 마감일 알림
- [ ] 미제출자 알림 (부장에게)

**체크리스트**:
- [ ] 알림 스케줄링 로직
- [ ] 이메일 알림 템플릿
- [ ] 인앱 알림 (선택사항)

---

### Task 5.2: 통합 보고서 알림
**우선순위**: 🟡 중간  
**예상 시간**: 1시간

- [ ] 통합 보고서 생성 알림 (팀원에게)
- [ ] 보고서 확정 알림 (상급자에게)

**체크리스트**:
- [ ] 알림 로직 구현
- [ ] 이메일 템플릿
- [ ] 인앱 알림 (선택사항)

---

### Task 5.3: 보드 페이지 통합
**우선순위**: 🟡 중간  
**예상 시간**: 1시간

- [ ] 보드 헤더에 "주간보고" 메뉴 추가
- [ ] 주간보고 작성 바로가기
- [ ] 통합 보고서 바로가기 (부장만)

**체크리스트**:
- [ ] 헤더 메뉴 추가
- [ ] 권한별 메뉴 표시
- [ ] 라우팅 설정

---

## 📅 전체 일정

| Phase | 기간 | 상태 |
|-------|------|------|
| Phase 1: DB & Backend | 2-3일 | ⬜ 미시작 |
| Phase 2: 주간보고 작성 UI | 3-4일 | ⬜ 미시작 |
| Phase 3: 통합 보고서 UI | 3-4일 | ⬜ 미시작 |
| Phase 4: 아카이브 | 1-2일 | ⬜ 미시작 |
| Phase 5: 알림 및 통합 | 1-2일 | ⬜ 미시작 |

**총 예상 기간**: 10-15일

---

## 🎯 MVP 우선순위

### 필수 (MVP)
1. ✅ Phase 1 전체
2. ✅ Task 2.1, 2.2, 2.4 (주간보고 작성 기본 기능)
3. ✅ Task 3.1, 3.2 (통합 보고서 기본 기능)
4. ✅ Task 5.3 (보드 페이지 통합)

### 선택 (Phase 2)
1. Task 2.3 (이슈사항 관리)
2. Task 3.3, 3.4 (보고서 편집 및 전송)
3. Task 4.1, 4.2 (아카이브)
4. Task 5.1, 5.2 (알림)

---

## ✅ 진행 상황 추적

각 Task를 완료할 때마다 체크박스를 체크하고, 완료 날짜를 기록하세요.

**예시**:
- [x] Task 1.1 - 완료 (2026-01-21)

---

## 📝 참고 문서

- [주간보고 기능 계획서](./WEEKLY_REPORT_FEATURE.md)
- [현재 기능 목록](./CURRENT_FEATURES.md)
- [아키텍처 문서](./ARCHITECTURE.md)
